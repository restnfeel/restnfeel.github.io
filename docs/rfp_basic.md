# Content Hub 모놀리식 관리 시스템 구현 명세서

> **프로젝트**: restnfeel.github.io — 바이브코딩 강의 중앙 관리 시스템
> **유형**: RFP / 구현 산출물 정리
> **작성일**: 2026-02-26

---

## 1. 배경 및 목적

### 문제 정의
- 강의별 개별 레포지토리(`vibe_coding_basic`, `vibe_coding_effiency` 등)를 각각 열어 수정해야 하는 비효율
- 강의 추가 시 메인 인덱스 페이지(`index.html`)를 수동 편집해야 하는 불편함
- 공통 테마·설정 변경 시 모든 레포를 개별 반영해야 하는 중복 작업

### 목표
- **단일 레포(모놀리식)**에서 모든 강의 콘텐츠와 메인 인덱스를 통합 관리
- 콘텐츠 변경 → GitHub Actions 자동 빌드 → 해당 레포 자동 배포
- 신규 강의 추가 시 표준화된 절차로 5분 내 셋업 완료

---

## 2. 시스템 아키텍처

### 레포지토리 역할

| 레포 | 역할 | 관리 방식 |
|------|------|-----------|
| `restnfeel.github.io` | 메인 인덱스 + **Content Hub** | 직접 관리 (이 레포) |
| `vibe_coding_basic` | 강의 1 호스팅 | gh-pages 브랜치만 사용 (CI 자동 배포) |
| `vibe_coding_effiency` | 강의 2 호스팅 | gh-pages 브랜치만 사용 (CI 자동 배포) |

### 데이터 흐름

```
[개발자]
   │
   ├── courses/basic/docs/*.md 수정
   │         └──► deploy-basic.yml 트리거
   │                   └──► Docusaurus 빌드
   │                             └──► vibe_coding_basic gh-pages 배포
   │
   ├── courses/effiency/docs/*.md 수정
   │         └──► deploy-effiency.yml 트리거
   │                   └──► Docusaurus 빌드
   │                             └──► vibe_coding_effiency gh-pages 배포
   │
   └── index/courses.json 수정
             └──► update-index.yml 트리거
                       └──► generate-index.js 실행
                                 └──► index.html 자동 커밋·푸시
```

---

## 3. 디렉토리 구조

```
restnfeel.github.io/
│
├── .github/workflows/
│   ├── deploy-basic.yml        # courses/basic/** 변경 시 자동 배포
│   ├── deploy-effiency.yml     # courses/effiency/** 변경 시 자동 배포
│   └── update-index.yml        # index/courses.json 변경 시 index.html 재생성
│
├── courses/
│   ├── basic/
│   │   ├── course.json         # 강의 메타데이터 (제목, 레벨, 챕터 수 등)
│   │   ├── docs/               # Docusaurus 문서 (.md / .mdx)
│   │   │   └── intro.md        # 강의 소개 (slug: /)
│   │   └── static/             # 강의별 정적 파일 (이미지 등)
│   │
│   └── effiency/
│       ├── course.json
│       ├── docs/
│       │   └── intro.md
│       └── static/
│
├── shared/
│   └── docusaurus-base/        # 모든 강의가 공유하는 Docusaurus 설정
│       ├── package.json        # Docusaurus v3.7.0 의존성
│       ├── docusaurus.config.js # course.json 읽어 설정 자동 주입
│       ├── sidebars.js         # autogenerated 사이드바
│       ├── docs/               # 빌드 시 courses/<id>/docs/로 교체됨
│       └── src/css/custom.css  # 공통 다크 테마 (메인 페이지와 통일)
│
├── index/
│   └── courses.json            # 메인 페이지 데이터 소스 (유일한 진실)
│
├── scripts/
│   └── generate-index.js       # courses.json → index.html 생성기
│
├── docs/
│   └── rfp_basic.md            # 이 문서
│
├── index.html                  # 자동 생성 파일 (직접 편집 금지)
└── ads.txt
```

---

## 4. 핵심 파일 명세

### 4.1 `index/courses.json`
메인 인덱스 페이지의 **유일한 데이터 소스**.

```json
{
  "site": {
    "title": "사이트 제목",
    "description": "설명",
    "brand": "브랜드명",
    "brandUrl": "https://...",
    "copyright": "© ..."
  },
  "courses": [
    {
      "id": "고유 ID",
      "repo": "GitHub 레포명",
      "url": "강의 URL",
      "title": "강의 제목",
      "description": "설명 (\\n으로 줄바꿈)",
      "level": "입문 | 중급 | 고급",
      "chapters": 6,
      "theme": "a | b | c | d",
      "tags": ["태그1", "태그2"],
      "status": "active | coming-soon"
    }
  ]
}
```

**`theme` 색상표:**

| 키 | 색상 | 용도 |
|----|------|------|
| `a` | 보라→파랑 | 기본 강의 |
| `b` | 하늘→청록 | 중급 강의 |
| `c` | 초록→민트 | 실습 강의 |
| `d` | 황금→노랑 | 특별 강의 |

### 4.2 `courses/<id>/course.json`
Docusaurus 빌드 시 `docusaurus.config.js`에서 읽는 강의 개별 메타데이터.

```json
{
  "id": "basic",
  "repo": "vibe_coding_basic",
  "url": "https://restnfeel.github.io/vibe_coding_basic/",
  "title": "강의 제목",
  "description": "강의 설명",
  "level": "입문",
  "chapters": 6,
  "theme": "a"
}
```

### 4.3 `scripts/generate-index.js`
`index/courses.json`을 읽어 `index.html`을 자동 생성하는 Node.js 스크립트.

- `status: "active"` 인 강의만 카드로 렌더링
- 테마별 CSS 동적 생성 (사용된 테마만 포함)
- HTML 특수문자 이스케이프 처리
- 실행: `node scripts/generate-index.js`

### 4.4 `shared/docusaurus-base/docusaurus.config.js`
빌드 디렉토리의 `course.json`을 런타임에 `require()`하여 설정 자동 주입.
- `title`, `baseUrl`, `projectName` 등 동적 설정
- `course.json` 없을 경우 fallback 기본값 사용

---

## 5. GitHub Actions 워크플로우

### 5.1 `deploy-basic.yml` / `deploy-effiency.yml`

**트리거:**
- `courses/<id>/**` 변경 시
- `shared/docusaurus-base/**` 변경 시 (공통 테마 업데이트 반영)
- 수동 실행 (`workflow_dispatch`)

**실행 순서:**
1. `shared/docusaurus-base/` → `/tmp/course-build/` 복사
2. `courses/<id>/docs/` → `/tmp/course-build/docs/` 복사 (덮어쓰기)
3. `courses/<id>/static/` → `/tmp/course-build/static/` 복사
4. `courses/<id>/course.json` → `/tmp/course-build/course.json` 복사
5. `npm install` + `npm run build`
6. `peaceiris/actions-gh-pages@v4`로 대상 레포 `gh-pages` 브랜치에 배포

### 5.2 `update-index.yml`

**트리거:** `index/courses.json` 변경 시

**실행 순서:**
1. `node scripts/generate-index.js` 실행
2. `index.html` 변경 감지 시 자동 커밋 (`[skip ci]` 태그로 루프 방지)
3. `git push`

---

## 6. 초기 설정 (1회성)

### Step 1. GitHub Personal Access Token 생성
- GitHub → Settings → Developer settings → Personal access tokens (classic)
- 권한: `repo` 전체 체크
- 이름 권장: `CONTENT_HUB_DEPLOY`

### Step 2. 시크릿 등록
- `restnfeel.github.io` 레포 → Settings → Secrets and variables → Actions
- **Name**: `DEPLOY_TOKEN`
- **Value**: Step 1에서 생성한 PAT

### Step 3. 대상 레포 GitHub Pages 설정
각 강의 레포(`vibe_coding_basic`, `vibe_coding_effiency`):
- Settings → Pages → Source: **Deploy from a branch**
- Branch: **`gh-pages`** / `/ (root)`

---

## 7. 신규 강의 추가 절차

1. **GitHub에서 레포 생성**: `restnfeel/vibe_coding_<새강의명>`
2. **콘텐츠 폴더 생성**:
   ```
   courses/<새강의명>/
   ├── course.json    (기존 것 복사 후 수정)
   ├── docs/intro.md
   └── static/
   ```
3. **워크플로우 추가**: `.github/workflows/deploy-<새강의명>.yml` (기존 것 복사 후 수정)
4. **인덱스 업데이트**: `index/courses.json`에 항목 추가
5. **Push** → 자동 배포 + 메인 인덱스 자동 업데이트

---

## 8. 일상적인 콘텐츠 관리

| 작업 | 편집 파일 | 자동 처리 |
|------|-----------|-----------|
| 강의 문서 추가/수정 | `courses/<id>/docs/*.md` | 해당 강의 레포 자동 배포 |
| 이미지 추가 | `courses/<id>/static/img/` | 해당 강의 레포 자동 배포 |
| 강의 카드 정보 변경 | `index/courses.json` | `index.html` 자동 재생성 |
| 공통 테마 변경 | `shared/docusaurus-base/src/css/custom.css` | 모든 강의 레포 자동 재배포 |
| Docusaurus 버전 업 | `shared/docusaurus-base/package.json` | 모든 강의 레포 자동 재배포 |

---

## 9. 주의사항

- `index.html`은 자동 생성 파일입니다. 직접 편집하지 말고 `index/courses.json`을 편집하세요.
- `DEPLOY_TOKEN`은 외부에 노출되지 않도록 반드시 GitHub Secrets에만 저장하세요.
- `shared/docusaurus-base/**` 변경 시 **모든 강의 워크플로우가 동시에 트리거**됩니다.
- Docusaurus 빌드는 약 2~3분 소요됩니다 (npm install 포함).
